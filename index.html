<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English 10 Global Success (Unit 6-8) - Advanced Practice</title>
    <style>
        :root { --primary: #1a237e; --secondary: #3949ab; --bg: #e8eaf6; --explain-bg: #fff8e1; --explain-text: #f57f17; --trans-text: #283593; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #c5cae9 0%, #e8eaf6 100%); margin: 0; min-height: 100vh; display: flex; flex-direction: column; align-items: center; user-select: none; padding-bottom: 50px; }
        
        .falling-flowers { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; opacity: 0.4; }
        .flower { position: absolute; top: -20px; animation: fall linear infinite; font-size: 20px; }
        @keyframes fall { to { transform: translateY(105vh) rotate(720deg); } }
        
        .container { 
            background: rgba(255,255,255,0.99); 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
            padding: 40px; 
            max-width: 950px; 
            width: 92%; 
            margin-top: 30px; 
            text-align: center; 
            z-index: 1; 
            border-top: 5px solid var(--primary); 
            position: relative;
            min-height: 400px;
            display: flex; flex-direction: column; justify-content: center;
        }
        
        .screen { width: 100%; }
        .hidden { display: none !important; }

        h1 { color: var(--primary); margin: 0 0 10px 0; font-size: 2.2rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 800; }
        h2 { color: #5c6bc0; font-weight: 500; margin-bottom: 30px; font-size: 1.2rem; }

        .question-box { 
            background: #fff; 
            padding: 25px; 
            border-radius: 8px; 
            margin: 20px 0; 
            font-size: 1.2rem; 
            color: #212121; 
            font-weight: 600; 
            border: 1px solid #c5cae9; 
            text-align: left;
            line-height: 1.6;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.01);
        }
        
        .reading-text {
            font-weight: normal;
            font-size: 1rem;
            background: #f5f5f5;
            padding: 20px;
            border-left: 4px solid var(--secondary);
            margin-bottom: 20px;
            white-space: pre-wrap;
            color: #37474f;
            line-height: 1.6;
        }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        @media (max-width: 700px) { .options-grid { grid-template-columns: 1fr; } }
        
        .btn-option { 
            background: white; 
            border: 2px solid #e0e0e0; 
            padding: 15px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            transition: 0.2s; 
            width: 100%; 
            text-align: left;
            color: #424242;
            min-height: 60px;
            display: flex; align-items: center;
        }
        .btn-option:hover { background: #e8eaf6; border-color: var(--primary); color: var(--primary); transform: translateY(-2px); }
        .btn-option.correct { background: #c8e6c9 !important; border-color: #4caf50 !important; color: #1b5e20; font-weight: bold; }
        .btn-option.wrong { background: #ffcdd2 !important; border-color: #e53935 !important; color: #b71c1c; opacity: 0.8; }
        
        .explanation-box { margin-top: 25px; padding: 20px; background-color: var(--explain-bg); color: #333; border-radius: 8px; border-left: 5px solid #ffb300; text-align: left; font-size: 1rem; animation: fadeIn 0.4s; }
        .explanation-title { font-weight: bold; color: #f57f17; text-transform: uppercase; font-size: 0.9rem; margin-bottom: 8px; display: block;}
        .trans-text { margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ffe082; color: var(--trans-text); font-style: italic; display: block; font-weight: 500;}

        .btn-main { background: var(--primary); color: white; border: none; padding: 15px 50px; border-radius: 30px; font-size: 1.2rem; cursor: pointer; margin-top: 20px; box-shadow: 0 5px 15px rgba(26, 35, 126, 0.3); transition: transform 0.1s; font-weight: bold; text-transform: uppercase; }
        .btn-main:active { transform: scale(0.95); }
        .btn-next { background: #ffca28; color: #212121; display: none; margin: 20px auto 0; width: 100%; max-width: 350px; }
        
        .info-bar { display: flex; justify-content: space-between; font-weight: bold; color: var(--primary); margin-bottom: 20px; font-size: 1.1rem; border-bottom: 2px solid #c5cae9; padding-bottom: 15px; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        #music-control { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: white; border: 3px solid var(--primary); color: var(--primary); font-size: 28px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 100; transition: all 0.3s; }
        .music-playing { animation: pulse 2s infinite; background: var(--primary) !important; color: white !important; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    <div class="falling-flowers" id="flowers"></div>
    
    <audio id="bg-music" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-12.mp3" type="audio/mpeg">
    </audio>
    <div id="music-control" onclick="toggleMusic()">üéµ</div>

    <div class="container">
        <div id="start-screen" class="screen">
            <h1>ENGLISH 10 GLOBAL SUCCESS</h1>
            <h2>Unit 6 - Unit 7 - Unit 8</h2>
            <div style="font-size: 5rem; margin: 30px;">‚öñÔ∏è üá∫üá≥ üíª</div>
            <p style="font-size: 1.2rem; line-height: 1.8; color: #455a64;">
                <b>Unit 6:</b> Gender Equality (Passive Voice with Modals)<br>
                <b>Unit 7:</b> International Organisations (Comparisons)<br>
                <b>Unit 8:</b> New Ways to Learn (Relative Clauses)
            </p>
            <button class="btn-main" onclick="startGame()">START PRACTICE ‚ñ∂</button>
        </div>

        <div id="game-ui" class="screen hidden">
            <div class="info-bar">
                <span id="score-display">Score: 0</span>
                <span id="progress-display">Question: 1/150</span>
            </div>
            
            <div class="question-box" id="question-text">Loading...</div>
            <div class="options-grid" id="options-container"></div>
            
            <div id="explanation-area" class="explanation-box hidden">
                <span class="explanation-title">üí° Explanation:</span>
                <span id="explanation-text"></span>
                <span id="trans-text" class="trans-text"></span>
            </div>

            <button id="btn-next" class="btn-main btn-next" onclick="nextQuestion()">‚û° NEXT QUESTION</button>
        </div>

        <div id="end-screen" class="screen hidden">
            <h1 style="color:var(--primary)">COMPLETED!</h1>
            <div style="font-size: 5rem; margin: 20px;">üéì</div>
            <h2 id="final-score" style="color: #1a237e; font-size: 2.5rem;"></h2>
            <p>Great job reviewing English 10!</p>
            <button class="btn-main" onclick="location.reload()">TRY AGAIN üîÑ</button>
        </div>
    </div>

<script>
    // ========================================================================
    // DATABASE: GLOBAL SUCCESS 10 (UNIT 6-7-8)
    // ========================================================================
    const rawQuestions = [
        // --- UNIT 6: GENDER EQUALITY ---
        // Phonetics: Stress in two-syllable words
        {q: "Choose the word with different stress pattern: <br>equal, gender, enrol, women", a: ["enrol", "equal", "gender", "women"], correct: 0, explain: "'enrol' (ƒë·ªông t·ª´) nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i (danh/t√≠nh t·ª´) nh·∫•n √¢m 1.", trans: "D·ªãch: enrol (ƒëƒÉng k√Ω h·ªçc), equal (b√¨nh ƒë·∫≥ng), gender (gi·ªõi t√≠nh), women (ph·ª• n·ªØ)."},
        {q: "Choose the word with different stress pattern: <br>physician, treatment, workforce, income", a: ["physician", "treatment", "workforce", "income"], correct: 0, explain: "'physician' nh·∫•n √¢m 2. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 1.", trans: "D·ªãch: physician (b√°c sƒ©), treatment (s·ª± ƒë·ªëi x·ª≠/ƒëi·ªÅu tr·ªã), workforce (l·ª±c l∆∞·ª£ng lao ƒë·ªông), income (thu nh·∫≠p)."},
        
        // Vocab
        {q: "Gender ______ should be eliminated in education and employment.", a: ["discrimination", "equality", "gap", "rights"], correct: 0, explain: "Gender discrimination (s·ª± ph√¢n bi·ªát ƒë·ªëi x·ª≠ gi·ªõi t√≠nh).", trans: "D·ªãch: Ph√¢n bi·ªát ƒë·ªëi x·ª≠ gi·ªõi t√≠nh c·∫ßn b·ªã lo·∫°i b·ªè trong gi√°o d·ª•c v√† vi·ªác l√†m."},
        {q: "We should provide equal ______ for both men and women.", a: ["opportunities", "powers", "forces", "strengths"], correct: 0, explain: "Equal opportunities (c∆° h·ªôi b√¨nh ƒë·∫≥ng).", trans: "D·ªãch: Ch√∫ng ta n√™n cung c·∫•p c∆° h·ªôi b√¨nh ƒë·∫≥ng cho c·∫£ nam v√† n·ªØ."},
        {q: "Women often do more ______ work than men.", a: ["domestic", "official", "social", "public"], correct: 0, explain: "Domestic work (vi·ªác nh√†).", trans: "D·ªãch: Ph·ª• n·ªØ th∆∞·ªùng l√†m nhi·ªÅu vi·ªác nh√† h∆°n nam gi·ªõi."},
        {q: "The government is trying to ______ gender inequality.", a: ["eliminate", "create", "cause", "increase"], correct: 0, explain: "Eliminate (lo·∫°i b·ªè/x√≥a b·ªè).", trans: "D·ªãch: Ch√≠nh ph·ªß ƒëang c·ªë g·∫Øng lo·∫°i b·ªè b·∫•t b√¨nh ƒë·∫≥ng gi·ªõi."},
        {q: "More women are joining the ______ these days.", a: ["workforce", "workplace", "working", "worker"], correct: 0, explain: "Join the workforce (tham gia l·ª±c l∆∞·ª£ng lao ƒë·ªông).", trans: "D·ªãch: Ng√†y nay c√≥ nhi·ªÅu ph·ª• n·ªØ tham gia l·ª±c l∆∞·ª£ng lao ƒë·ªông h∆°n."},
        
        // Grammar Unit 6: Passive Voice with Modals
        {q: "This job ______ by a man or a woman.", a: ["can be done", "can do", "can be doing", "can done"], correct: 0, explain: "B·ªã ƒë·ªông v·ªõi Modal Verbs: Modal + be + V3/ed.", trans: "D·ªãch: C√¥ng vi·ªác n√†y c√≥ th·ªÉ ƒë∆∞·ª£c th·ª±c hi·ªán b·ªüi nam ho·∫∑c n·ªØ."},
        {q: "Gender discrimination ______ eliminated.", a: ["must be", "must", "must been", "must be being"], correct: 0, explain: "Must be + V3/ed.", trans: "D·ªãch: Ph√¢n bi·ªát gi·ªõi t√≠nh ph·∫£i b·ªã lo·∫°i b·ªè."},
        {q: "Women ______ given equal rights.", a: ["should be", "should", "should have", "should been"], correct: 0, explain: "Should be + V3/ed.", trans: "D·ªãch: Ph·ª• n·ªØ n√™n ƒë∆∞·ª£c trao quy·ªÅn b√¨nh ƒë·∫≥ng."},
        {q: "The rules ______ by everyone.", a: ["must be obeyed", "must obey", "must obeyed", "must be obeying"], correct: 0, explain: "Must be obeyed (ph·∫£i ƒë∆∞·ª£c tu√¢n th·ªß).", trans: "D·ªãch: C√°c quy ƒë·ªãnh ph·∫£i ƒë∆∞·ª£c m·ªçi ng∆∞·ªùi tu√¢n th·ªß."},

        // --- UNIT 7: VIETNAM AND INTERNATIONAL ORGANISATIONS ---
        // Phonetics: Stress in words ending in -tion, -sion, -ic, -al
        {q: "Choose the word with different stress pattern: <br>nation, donation, relation, pollution", a: ["nation", "donation", "relation", "pollution"], correct: 0, explain: "'nation' nh·∫•n √¢m 1. C√°c t·ª´ c√≤n l·∫°i nh·∫•n √¢m 2 (tr∆∞·ªõc ƒëu√¥i -tion).", trans: "D·ªãch: nation (qu·ªëc gia) - donation (s·ª± quy√™n g√≥p) - relation (m·ªëi quan h·ªá) - pollution (√¥ nhi·ªÖm)."},
        {q: "Choose the word with different stress pattern: <br>economic, specific, historic, politics", a: ["politics", "economic", "specific", "historic"], correct: 0, explain: "'politics' nh·∫•n √¢m 1. C√°c t·ª´ ƒëu√¥i -ic nh·∫•n √¢m li·ªÅn tr∆∞·ªõc n√≥.", trans: "D·ªãch: politics (ch√≠nh tr·ªã) - c√°c t·ª´ kh√°c nh·∫•n √¢m ti·∫øt tr∆∞·ªõc -ic."},

        // Vocab
        {q: "UNICEF aims to support the most disadvantaged children ______.", a: ["worldwide", "locally", "nationally", "citywide"], correct: 0, explain: "Worldwide (tr√™n to√†n th·∫ø gi·ªõi).", trans: "D·ªãch: UNICEF nh·∫±m h·ªó tr·ª£ nh·ªØng tr·∫ª em thi·ªát th√≤i nh·∫•t tr√™n to√†n th·∫ø gi·ªõi."},
        {q: "Vietnam has become a member of many international ______.", a: ["organisations", "programs", "partners", "companies"], correct: 0, explain: "International organisations (t·ªï ch·ª©c qu·ªëc t·∫ø).", trans: "D·ªãch: Vi·ªát Nam ƒë√£ tr·ªü th√†nh th√†nh vi√™n c·ªßa nhi·ªÅu t·ªï ch·ª©c qu·ªëc t·∫ø."},
        {q: "We need to improve our ______ with other countries.", a: ["relations", "relatives", "relationship", "relating"], correct: 0, explain: "Relations (quan h·ªá ngo·∫°i giao/qu·ªëc t·∫ø).", trans: "D·ªãch: Ch√∫ng ta c·∫ßn c·∫£i thi·ªán quan h·ªá v·ªõi c√°c n∆∞·ªõc kh√°c."},
        {q: "WHO stands for World ______ Organization.", a: ["Health", "Human", "Heart", "Healing"], correct: 0, explain: "World Health Organization (T·ªï ch·ª©c Y t·∫ø Th·∫ø gi·ªõi).", trans: "D·ªãch: WHO vi·∫øt t·∫Øt c·ªßa T·ªï ch·ª©c Y t·∫ø Th·∫ø gi·ªõi."},
        {q: "Vietnam sent officers to join the UN ______ forces.", a: ["peacekeeping", "peacemaking", "peaceful", "peace"], correct: 0, explain: "Peacekeeping forces (l·ª±c l∆∞·ª£ng g√¨n gi·ªØ h√≤a b√¨nh).", trans: "D·ªãch: Vi·ªát Nam ƒë√£ c·ª≠ sƒ© quan tham gia l·ª±c l∆∞·ª£ng g√¨n gi·ªØ h√≤a b√¨nh Li√™n H·ª£p Qu·ªëc."},
        {q: "The main goal of ASEAN is to promote economic ______.", a: ["growth", "grow", "grown", "growing"], correct: 0, explain: "Economic growth (tƒÉng tr∆∞·ªüng kinh t·∫ø).", trans: "D·ªãch: M·ª•c ti√™u ch√≠nh c·ªßa ASEAN l√† th√∫c ƒë·∫©y tƒÉng tr∆∞·ªüng kinh t·∫ø."},

        // Grammar Unit 7: Comparative & Superlative / Present Perfect
        {q: "This organization is ______ than that one.", a: ["larger", "large", "largest", "more large"], correct: 0, explain: "So s√°nh h∆°n t√≠nh t·ª´ ng·∫Øn: adj + er + than.", trans: "D·ªãch: T·ªï ch·ª©c n√†y l·ªõn h∆°n t·ªï ch·ª©c kia."},
        {q: "Viet Nam is one of the ______ members of ASEAN.", a: ["most active", "more active", "active", "activeness"], correct: 0, explain: "So s√°nh nh·∫•t t√≠nh t·ª´ d√†i: the + most + adj.", trans: "D·ªãch: Vi·ªát Nam l√† m·ªôt trong nh·ªØng th√†nh vi√™n t√≠ch c·ª±c nh·∫•t c·ªßa ASEAN."},
        {q: "This is the ______ project I have ever joined.", a: ["most interesting", "more interesting", "interesting", "interest"], correct: 0, explain: "So s√°nh nh·∫•t + th√¨ hi·ªán t·∫°i ho√†n th√†nh.", trans: "D·ªãch: ƒê√¢y l√† d·ª± √°n th√∫ v·ªã nh·∫•t t√¥i t·ª´ng tham gia."},
        {q: "Vietnam ______ a member of the UN in 1977.", a: ["became", "has become", "becomes", "become"], correct: 0, explain: "M·ªëc th·ªùi gian c·ª• th·ªÉ trong qu√° kh·ª© (in 1977) -> Qu√° kh·ª© ƒë∆°n.", trans: "D·ªãch: Vi·ªát Nam tr·ªü th√†nh th√†nh vi√™n LHQ nƒÉm 1977."},
        {q: "We ______ UNICEF since 2010.", a: ["have supported", "supported", "support", "will support"], correct: 0, explain: "Since + m·ªëc th·ªùi gian -> Hi·ªán t·∫°i ho√†n th√†nh.", trans: "D·ªãch: Ch√∫ng t√¥i ƒë√£ h·ªó tr·ª£ UNICEF t·ª´ nƒÉm 2010."},

        // --- UNIT 8: NEW WAYS TO LEARN ---
        // Vocab
        {q: "______ learning allows students to learn both online and in class.", a: ["Blended", "Traditional", "Face-to-face", "Offline"], correct: 0, explain: "Blended learning (H·ªçc t·∫≠p k·∫øt h·ª£p).", trans: "D·ªãch: H·ªçc t·∫≠p k·∫øt h·ª£p cho ph√©p h·ªçc sinh h·ªçc c·∫£ tr·ª±c tuy·∫øn v√† tr√™n l·ªõp."},
        {q: "You can use a digital ______ like a tablet or smartphone to learn.", a: ["device", "tool", "machine", "appliance"], correct: 0, explain: "Digital device (thi·∫øt b·ªã s·ªë).", trans: "D·ªãch: B·∫°n c√≥ th·ªÉ d√πng thi·∫øt b·ªã s·ªë nh∆∞ m√°y t√≠nh b·∫£ng ho·∫∑c ƒëi·ªán tho·∫°i ƒë·ªÉ h·ªçc."},
        {q: "Students can have ______ to a huge variety of information online.", a: ["access", "assess", "accept", "aspect"], correct: 0, explain: "Have access to (c√≥ quy·ªÅn truy c·∫≠p/ti·∫øp c·∫≠n).", trans: "D·ªãch: H·ªçc sinh c√≥ th·ªÉ ti·∫øp c·∫≠n l∆∞·ª£ng th√¥ng tin kh·ªïng l·ªì tr·ª±c tuy·∫øn."},
        {q: "Online learning gives us more ______ over our schedule.", a: ["control", "money", "strategy", "project"], correct: 0, explain: "Control (s·ª± ki·ªÉm so√°t/ch·ªß ƒë·ªông).", trans: "D·ªãch: H·ªçc tr·ª±c tuy·∫øn cho ch√∫ng ta s·ª± ch·ªß ƒë·ªông h∆°n v·ªÅ l·ªãch tr√¨nh."},
        {q: "Too much screen time can be a ______.", a: ["distraction", "distract", "distracted", "distracting"], correct: 0, explain: "Distraction (s·ª± xao nh√£ng/g√¢y m·∫•t t·∫≠p trung).", trans: "D·ªãch: Th·ªùi gian nh√¨n m√†n h√¨nh qu√° nhi·ªÅu c√≥ th·ªÉ g√¢y xao nh√£ng."},
        {q: "Teachers can upload materials for students to ______ at home.", a: ["download", "upload", "load", "offload"], correct: 0, explain: "Download (t·∫£i xu·ªëng).", trans: "D·ªãch: Gi√°o vi√™n c√≥ th·ªÉ t·∫£i t√†i li·ªáu l√™n ƒë·ªÉ h·ªçc sinh t·∫£i v·ªÅ t·∫°i nh√†."},

        // Grammar Unit 8: Relative Clauses
        {q: "The tablet ______ I bought yesterday is very fast.", a: ["which", "who", "whose", "where"], correct: 0, explain: "Tablet (v·∫≠t) -> d√πng Which/That.", trans: "D·ªãch: Chi·∫øc m√°y t√≠nh b·∫£ng m√† t√¥i mua h√¥m qua r·∫•t nhanh."},
        {q: "The teacher ______ teaches us English is from Australia.", a: ["who", "which", "whose", "whom"], correct: 0, explain: "Teacher (ng∆∞·ªùi) -> d√πng Who.", trans: "D·ªãch: Gi√°o vi√™n d·∫°y ti·∫øng Anh cho ch√∫ng t√¥i ƒë·∫øn t·ª´ √öc."},
        {q: "This is the app ______ helps me learn vocabulary.", a: ["that", "who", "where", "when"], correct: 0, explain: "App (v·∫≠t) -> d√πng That/Which.", trans: "D·ªãch: ƒê√¢y l√† ·ª©ng d·ª•ng gi√∫p t√¥i h·ªçc t·ª´ v·ª±ng."},
        {q: "Mr. Minh, ______ son is my friend, is a doctor.", a: ["whose", "who", "which", "that"], correct: 0, explain: "Whose + Noun (ch·ªâ s·ªü h·ªØu: con trai c·ªßa √¥ng ·∫•y).", trans: "D·ªãch: √îng Minh, ng∆∞·ªùi c√≥ con trai l√† b·∫°n t√¥i, l√† m·ªôt b√°c sƒ©."},
        {q: "My laptop, ______ I use for studying, is broken.", a: ["which", "that", "who", "whose"], correct: 0, explain: "M·ªánh ƒë·ªÅ quan h·ªá kh√¥ng x√°c ƒë·ªãnh (c√≥ d·∫•u ph·∫©y) -> Kh√¥ng d√πng That, d√πng Which cho v·∫≠t.", trans: "D·ªãch: Laptop c·ªßa t√¥i, c√°i m√† t√¥i d√πng ƒë·ªÉ h·ªçc, ƒë√£ b·ªã h·ªèng."},

        // --- READING COMPREHENSION ---
        {
            q: "<div class='reading-text'>Blended learning is a way of studying that combines online learning with face-to-face instruction. Students can watch video lectures at home and do exercises in class. This helps them learn at their own pace. However, it requires students to be disciplined and have good time management skills.</div>\nWhat is blended learning?", 
            a: ["A combination of online and face-to-face learning", "Only learning online", "Only learning in class", "Watching videos only"], 
            correct: 0, 
            explain: "Text: '...combines online learning with face-to-face instruction.'", 
            trans: "D·ªãch: H·ªçc k·∫øt h·ª£p l√† g√¨? -> S·ª± k·∫øt h·ª£p gi·ªØa h·ªçc online v√† tr·ª±c ti·∫øp."
        },
        {
            q: "<div class='reading-text'>UNICEF works in over 190 countries and territories to save children's lives, to defend their rights, and to help them fulfill their potential, from early childhood through adolescence.</div>\nWhat is the main purpose of UNICEF?", 
            a: ["To help children", "To improve economy", "To stop wars", "To trade goods"], 
            correct: 0, 
            explain: "Text: '...to save children's lives...'", 
            trans: "D·ªãch: M·ª•c ƒë√≠ch ch√≠nh c·ªßa UNICEF l√† g√¨? -> Gi√∫p ƒë·ª° tr·∫ª em."
        },

        // --- ERROR IDENTIFICATION ---
        {q: "Find the mistake: <br>The woman <u>which</u> <u>is</u> standing <u>there</u> is <u>my</u> aunt.", a: ["which", "is", "there", "my"], correct: 0, explain: "Sai 'which'. Ng∆∞·ªùi (The woman) ph·∫£i d√πng 'who'.", trans: "D·ªãch: Ng∆∞·ªùi ph·ª• n·ªØ ƒëang ƒë·ª©ng ƒë√≥ l√† d√¨ c·ªßa t√¥i."},
        {q: "Find the mistake: <br>This task <u>should</u> <u>done</u> <u>by</u> tomorrow.", a: ["done", "should", "by", "tomorrow"], correct: 0, explain: "Sai 'done'. B·ªã ƒë·ªông v·ªõi Modal: should + BE + done.", trans: "D·ªãch: Nhi·ªám v·ª• n√†y n√™n ƒë∆∞·ª£c ho√†n th√†nh tr∆∞·ªõc ng√†y mai."},
        {q: "Find the mistake: <br>Ha Long Bay is <u>the</u> <u>more</u> beautiful <u>place</u> I <u>have</u> ever visited.", a: ["more", "the", "place", "have"], correct: 0, explain: "Sai 'more'. So s√°nh nh·∫•t ph·∫£i l√† 'most'.", trans: "D·ªãch: V·ªãnh H·∫° Long l√† n∆°i ƒë·∫πp nh·∫•t t√¥i t·ª´ng ƒë·∫øn."},

        // --- SENTENCE BUILDING ---
        {q: "Rearrange: be / Gender / eliminated / discrimination / should / .", a: ["Gender discrimination should be eliminated.", "Gender eliminated should be discrimination.", "Discrimination gender should be eliminated.", "Should be eliminated gender discrimination."], correct: 0, explain: "Passive Modal: S + should be + V3.", trans: "D·ªãch: Ph√¢n bi·ªát gi·ªõi t√≠nh n√™n b·ªã lo·∫°i b·ªè."},
        {q: "Rearrange: joined / Vietnam / in / 1995 / ASEAN / .", a: ["Vietnam joined ASEAN in 1995.", "ASEAN joined Vietnam in 1995.", "In 1995 joined Vietnam ASEAN.", "Vietnam in 1995 joined ASEAN."], correct: 0, explain: "S + V + O + Time.", trans: "D·ªãch: Vi·ªát Nam gia nh·∫≠p ASEAN nƒÉm 1995."},
        {q: "Rearrange: man / The / who / called / is / teacher / my / .", a: ["The man who called is my teacher.", "The man is my teacher who called.", "Who called the man is my teacher.", "The teacher who called is my man."], correct: 0, explain: "Relative Clause: S + who + V... + is...", trans: "D·ªãch: Ng∆∞·ªùi ƒë√†n √¥ng v·ª´a g·ªçi ƒëi·ªán l√† gi√°o vi√™n c·ªßa t√¥i."},
    ];

    // ========================================================================
    // GENERATOR: T·ª∞ ƒê·ªòNG SINH C√ÇU H·ªéI NG·ªÆ PH√ÅP (ƒê·ªÇ ƒê·ª¶ 150 C√ÇU KH√îNG TR√ôNG)
    // ========================================================================

    // 1. GENERATOR: Passive Voice with Modals (Unit 6)
    const passiveSubj = ["The report", "The letter", "The project", "The house", "The problem", "The rule"];
    const modals = [
        {m: "must", meaning: "ph·∫£i"},
        {m: "should", meaning: "n√™n"},
        {m: "can", meaning: "c√≥ th·ªÉ"},
        {m: "might", meaning: "c√≥ l·∫Ω"}
    ];
    const verbs = [
        {v: "finished", meaning: "ho√†n th√†nh"},
        {v: "solved", meaning: "gi·∫£i quy·∫øt"},
        {v: "cleaned", meaning: "d·ªçn d·∫πp"},
        {v: "sent", meaning: "g·ª≠i ƒëi"},
        {v: "built", meaning: "x√¢y d·ª±ng"}
    ];

    for(let i=0; i<30; i++) {
        let s = passiveSubj[i % passiveSubj.length];
        let m = modals[i % modals.length];
        let v = verbs[i % verbs.length];
        rawQuestions.push({
            q: `Grammar: ${s} ______ be ${v.v} immediately.`,
            a: [m.m, `${m.m} be`, `to ${m.m}`, `is ${m.m}`],
            correct: 0,
            explain: `C·∫•u tr√∫c b·ªã ƒë·ªông khuy·∫øt thi·∫øu: S + ${m.m} + be + V3/ed.`,
            trans: `D·ªãch: ${s} ${m.meaning} ƒë∆∞·ª£c ${v.meaning} ngay l·∫≠p t·ª©c.`
        });
    }

    // 2. GENERATOR: Relative Clauses (Unit 8)
    const relNouns = [
        {n: "The laptop", type: "thing", trans: "C√°i laptop"},
        {n: "The girl", type: "person", trans: "C√¥ g√°i"},
        {n: "The singer", type: "person", trans: "Ca sƒ©"},
        {n: "The song", type: "thing", trans: "B√†i h√°t"},
        {n: "The robot", type: "thing", trans: "Con robot"}
    ];
    const relVerbs = ["is standing there", "I bought", "is famous", "we saw", "is broken"];

    for(let i=0; i<30; i++) {
        let n = relNouns[i % relNouns.length];
        let v = relVerbs[i % relVerbs.length];
        let correctRel = n.type === "person" ? "who" : "which";
        let wrongRel = n.type === "person" ? "which" : "who";
        
        rawQuestions.push({
            q: `Grammar: ${n.n} ______ ${v} is mine/my favorite.`,
            a: [correctRel, wrongRel, "where", "when"],
            correct: 0,
            explain: `${n.n} l√† danh t·ª´ ch·ªâ ${n.type === "person" ? "ng∆∞·ªùi -> d√πng Who" : "v·∫≠t -> d√πng Which"}.`,
            trans: `D·ªãch: ${n.trans} m√† ${v} l√† c·ªßa t√¥i/y√™u th√≠ch c·ªßa t√¥i.`
        });
    }

    // 3. GENERATOR: Comparisons (Unit 7)
    const adjectives = [
        {adj: "rich", comp: "richer", sup: "richest", meaning: "gi√†u"},
        {adj: "big", comp: "bigger", sup: "biggest", meaning: "l·ªõn"},
        {adj: "fast", comp: "faster", sup: "fastest", meaning: "nhanh"},
        {adj: "beautiful", comp: "more beautiful", sup: "most beautiful", meaning: "ƒë·∫πp"},
        {adj: "expensive", comp: "more expensive", sup: "most expensive", meaning: "ƒë·∫Øt"}
    ];

    for(let i=0; i<30; i++) {
        let adj = adjectives[i % adjectives.length];
        // Mix between Comparative (Than) and Superlative (The)
        if (i % 2 === 0) {
            rawQuestions.push({
                q: `Grammar: This car is ______ than that one.`,
                a: [adj.comp, adj.sup, adj.adj, `as ${adj.adj}`],
                correct: 0,
                explain: `So s√°nh h∆°n (c√≥ 'than') -> ${adj.comp}.`,
                trans: `D·ªãch: Chi·∫øc xe n√†y ${adj.meaning} h∆°n chi·∫øc kia.`
            });
        } else {
            rawQuestions.push({
                q: `Grammar: He is the ______ person in the room.`,
                a: [adj.sup, adj.comp, adj.adj, `more ${adj.adj}`],
                correct: 0,
                explain: `So s√°nh nh·∫•t (c√≥ 'the') -> ${adj.sup}.`,
                trans: `D·ªãch: Anh ·∫•y l√† ng∆∞·ªùi ${adj.meaning} nh·∫•t trong ph√≤ng.`
            });
        }
    }

    // ========================================================================
    // GAME LOGIC
    // ========================================================================
    let questions = []; 
    let currentQuestionIndex = 0;
    let score = 0;
    let isPlaying = false;
    const audio = document.getElementById('bg-music');

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function toggleMusic() {
        if (audio.paused) {
            audio.play().catch(e => alert("Please touch the screen first!"));
            document.getElementById('music-control').classList.add('music-playing');
        } else {
            audio.pause();
            document.getElementById('music-control').classList.remove('music-playing');
        }
    }

    function startGame() {
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('end-screen').classList.add('hidden');
        document.getElementById('game-ui').classList.remove('hidden');

        score = 0;
        currentQuestionIndex = 0;
        questions = shuffleArray([...rawQuestions]).slice(0, 150); 
        
        isPlaying = true;
        updateScore();
        showQuestion();

        if(audio.paused) toggleMusic();
    }

    function showQuestion() {
        if (currentQuestionIndex >= questions.length) {
            endGame();
            return;
        }
        
        const qData = questions[currentQuestionIndex];
        
        document.getElementById('question-text').innerHTML = `[${currentQuestionIndex + 1}] ${qData.q}`;
        document.getElementById('progress-display').innerText = `Question: ${currentQuestionIndex + 1}/${questions.length}`;
        
        document.getElementById('explanation-area').classList.add('hidden');
        document.getElementById('btn-next').style.display = 'none';

        const optionsDiv = document.getElementById('options-container');
        optionsDiv.innerHTML = '';
        let indices = [0, 1, 2, 3];
        shuffleArray(indices);

        indices.forEach(index => {
            const btn = document.createElement('button');
            btn.className = 'btn-option';
            btn.innerHTML = qData.a[index]; 
            btn.onclick = () => checkAnswer(index, qData.correct, btn);
            optionsDiv.appendChild(btn);
        });
    }

    function checkAnswer(selectedIndex, correctIndex, btnElement) {
        if (!isPlaying) return;
        
        const allBtns = document.querySelectorAll('.btn-option');
        allBtns.forEach(b => b.disabled = true);

        if (selectedIndex === correctIndex) {
            btnElement.classList.add('correct');
            score += 10;
        } else {
            btnElement.classList.add('wrong');
            allBtns.forEach(b => {
                if(b.innerHTML === questions[currentQuestionIndex].a[correctIndex]) {
                    b.classList.add('correct');
                }
            });
        }
        updateScore();

        // HI·ªÜN GI·∫¢I TH√çCH & D·ªäCH
        document.getElementById('explanation-text').innerText = questions[currentQuestionIndex].explain;
        
        const transEl = document.getElementById('trans-text');
        if(questions[currentQuestionIndex].trans) {
            transEl.innerText = questions[currentQuestionIndex].trans;
            transEl.style.display = 'block';
        } else {
            transEl.style.display = 'none';
        }

        document.getElementById('explanation-area').classList.remove('hidden');
        document.getElementById('btn-next').style.display = 'block';
    }

    function nextQuestion() {
        currentQuestionIndex++;
        showQuestion();
    }

    function updateScore() {
        document.getElementById('score-display').innerText = `Score: ${score}`;
    }

    function endGame() {
        isPlaying = false;
        document.getElementById('game-ui').classList.add('hidden');
        document.getElementById('end-screen').classList.remove('hidden');
        document.getElementById('final-score').innerText = `Total Score: ${score} / ${questions.length * 10}`;
    }
    
    // Create flowers
    function createFlowers() {
        const container = document.getElementById('flowers');
        const symbols = ['üìù', 'üìö', 'üåè', 'üí°', 'üéì']; 
        for(let i=0; i<25; i++) {
            const el = document.createElement('div');
            el.className = 'flower';
            el.innerText = symbols[Math.floor(Math.random()*symbols.length)];
            el.style.left = Math.random() * 100 + 'vw';
            el.style.fontSize = (Math.random() * 20 + 15) + 'px';
            el.style.animationDuration = (Math.random() * 5 + 5) + 's';
            el.style.animationDelay = Math.random() * 5 + 's';
            container.appendChild(el);
        }
    }
    createFlowers();
</script>
</body>
</html>